# 메신저 Docs 자동 기록기 사용 설명서

안녕하세요! "메신저 Docs 자동 기록기"를 사용해주셔서 감사합니다.
이 프로그램은 여러분이 지정한 폴더에 있는 텍스트 파일(`.txt`)에 새로운 내용이 추가될 때마다, 그 내용을 자동으로 여러분의 Google Docs 문서에 옮겨 적어주는 편리한 도구입니다.

**주요 기능:**

* **자동 기록:** 한번 설정해두면 프로그램이 알아서 폴더를 감시하고 새 내용을 Google Docs에 추가합니다.
* **Google Docs 연동:** 중요한 대화나 메모를 안전한 Google Docs에 백업하고 언제든 확인할 수 있습니다.
* **중복 방지:** 이미 Google Docs에 기록된 내용은 다시 추가하지 않아 깔끔하게 관리됩니다.
* **간편 설정:** 쉬운 인터페이스를 통해 감시할 폴더, Google 인증 파일, Google Docs 주소를 설정할 수 있습니다.
* **백그라운드 작동:** 실행 후 창을 닫아도 작업 표시줄 트레이 아이콘으로 최소화되어 조용히 작동합니다.

**준비물:**

1.  **Windows PC**
2.  **인터넷 연결** (Google Docs 동기화를 위해 필수)
3.  **Google 계정**
4.  **Google Cloud `credentials.json` 파일** (아래 '최초 설정' 참조)
5.  **기록을 저장할 Google Docs 문서**

**최초 설정 (처음 사용할 때만 필요)**

이 프로그램이 여러분의 Google Docs에 접근하려면 Google의 허가가 필요합니다. 이를 위해 약간의 설정이 필요합니다.

1.  **Google Docs 문서 준비:**
    * Google Drive에서 기록을 저장할 새 Google Docs 문서를 만듭니다.
    * 문서를 열고 웹 브라우저 주소창에서 **문서의 URL 주소 전체** 또는 `/d/` 와 `/edit` 사이의 **긴 ID 문자열**을 복사해 둡니다. (예: `https://docs.google.com/document/d/ABCDEFG12345/edit` 또는 `ABCDEFG12345`)

2.  **`credentials.json` 파일 얻기 (Google Cloud 설정):**
    * **주의:** 이 과정은 약간 기술적일 수 있습니다. 보안을 위해 꼭 필요한 단계입니다.
    * 웹 브라우저에서 [Google Cloud Console](https://console.cloud.google.com/) 에 접속하여 Google 계정으로 로그인합니다.
    * 새 프로젝트를 만듭니다 (이름은 자유롭게).
    * 왼쪽 메뉴에서 'API 및 서비스' > '라이브러리'로 이동하여 `Google Docs API`를 검색하고 **활성화(Enable)**합니다.
    * 왼쪽 메뉴에서 'API 및 서비스' > **'OAuth 동의 화면(OAuth consent screen)'**으로 이동합니다.
        * 'User Type'은 **'External'** 선택 후 만들기.
        * 앱 이름(예: `내 자동 기록기`), 사용자 지원 이메일, 개발자 연락처 이메일(본인 이메일)을 입력하고 저장 후 계속 진행합니다.
        * '범위(Scopes)' 단계는 건너뛰고 저장 후 계속 진행합니다.
        * '테스트 사용자(Test users)' 단계에서 '+ ADD USERS'를 눌러 **본인의 Google 계정 이메일**을 추가하고 저장 후 계속 진행합니다.
    * 왼쪽 메뉴에서 'API 및 서비스' > **'사용자 인증 정보(Credentials)'**로 이동합니다.
    * 상단의 '+ 사용자 인증 정보 만들기' > **'OAuth 클라이언트 ID'** 를 선택합니다.
    * '애플리케이션 유형'을 **'데스크톱 앱(Desktop app)'** 으로 선택하고 이름을 지정한 후 '만들기'를 클릭합니다.
    * 팝업 창이 뜨면 **'JSON 다운로드'** 버튼을 클릭하여 파일을 받습니다.
    * 다운로드한 파일의 이름을 **`credentials.json`** 으로 변경하고, 이 프로그램을 실행하는 `.exe` 파일과 **같은 폴더**에 저장합니다.
    * **매우 중요:** `credentials.json` 파일은 비밀 정보입니다. **절대로 다른 사람과 공유하지 마세요.**

**사용 방법:**

1.  **프로그램 실행:** 다운로드한 `.exe` 파일을 더블 클릭하여 실행합니다.
2.  **설정 입력:**
    * **감시 폴더:** '폴더 선택...' 버튼을 눌러 메신저 대화 내용 등이 저장되는 `.txt` 파일이 있는 폴더를 지정합니다.
    * **Credentials 파일:** '파일 선택...' 버튼을 눌러 위에서 준비한 `credentials.json` 파일을 선택합니다.
    * **Google Docs URL/ID:** 준비해 둔 Google Docs 문서의 주소 또는 ID를 입력합니다.
3.  **설정 저장:** '설정 저장' 버튼을 누르면 입력한 내용이 저장되어 다음 실행 시 자동으로 불러옵니다. (`config.json` 파일 생성)
4.  **Google 계정 인증 (최초 실행 시):**
    * '감시 시작' 버튼을 처음 누르면 웹 브라우저가 열리며 Google 로그인 및 권한 동의 화면이 나타납니다.
    * 로그인하고 프로그램이 Google Docs에 접근하는 것을 **허용**합니다.
    * 성공하면 `.exe` 파일이 있는 폴더에 `token.json` 파일이 생성됩니다. (이 파일도 외부에 유출되지 않도록 주의하세요.)
5.  **감시 시작:** '감시 시작' 버튼을 누르면 폴더 감시 및 자동 기록이 시작됩니다. 로그 창에 진행 상황이 표시됩니다.
6.  **감시 중지:** 자동 기록을 멈추고 싶으면 '감시 중지' 버튼을 누릅니다.
7.  **트레이 아이콘:**
    * 프로그램 창 오른쪽 위의 X 버튼을 누르면 프로그램이 종료되지 않고 작업 표시줄 트레이 영역(시계 옆)에 아이콘으로 최소화됩니다.
    * 트레이 아이콘을 우클릭하면 '보이기/숨기기' 또는 '종료' 메뉴를 사용할 수 있습니다. '종료'를 선택해야 프로그램이 완전히 종료됩니다.

**참고 사항:**

* Google Docs에 내용을 기록하려면 **인터넷 연결이 필수**입니다.
* 프로그램은 지정된 폴더의 `.txt` 파일에 **새롭게 추가된 텍스트 라인만** Google Docs로 보냅니다. 기존 내용을 수정하거나 삭제하는 것은 반영되지 않습니다.
* Google Docs 접근에 문제가 생기면 `credentials.json` 파일이 올바른지, 인터넷 연결이 정상인지 확인해 보세요.
* 설정 정보는 `config.json`, 중복 방지를 위한 기록 캐시는 `added_lines_cache.json` 파일에 저장됩니다. 이 파일들은 `.exe` 파일과 같은 폴더에 생성됩니다.
* 자세한 작동 내역은 프로그램 창의 로그 영역에서 확인할 수 있습니다.

**보안 안내:**

`credentials.json` 파일과 `token.json` 파일은 여러분의 Google 계정 접근 권한과 관련된 중요한 정보입니다. **절대로 다른 사람에게 공유하거나, 이메일/메신저 등으로 전송하거나, 공개된 장소에 업로드하지 마세요.**

---
궁금한 점이나 문제가 발생하면 개발자에게 문의해주세요.