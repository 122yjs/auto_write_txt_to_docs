## ğŸš€ í”„ë¡œì íŠ¸ ê°œì„ : Google ì¸ì¦ ê³¼ì • ì‰½ê²Œ ë§Œë“¤ê¸° (credentials.json ìë™í™”)

ì•ˆë…•í•˜ì„¸ìš”! 10ë…„ ì°¨ ê°œë°œìì´ì êµìœ¡ìì…ë‹ˆë‹¤. ğŸ˜Š
ì´ˆë³´ ê°œë°œìë¶„ì´ Google API ì¸ì¦ ê³¼ì •ì—ì„œ ê²ªëŠ” ì–´ë ¤ì›€ì„ ì‹œì›í•˜ê²Œ í•´ê²°í•´ ë“œë¦¬ê³ ì í•©ë‹ˆë‹¤. ì‚¬ìš©ìê°€ ë³µì¡í•œ ì„¤ì • ì—†ì´ í”„ë¡œê·¸ë¨ì„ ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡, ì¸ì¦ íŒŒì¼ì„ í”„ë¡œê·¸ë¨ì— í¬í•¨í•˜ëŠ” ë°©ë²•ì„ ë‹¨ê³„ë³„ë¡œ ì•„ì£¼ ì‰½ê²Œ ì„¤ëª…í•´ ë“œë¦´ê²Œìš”. ë§ˆì¹˜ ë¸”ë¡ ìŒ“ê¸°ì²˜ëŸ¼ í•˜ë‚˜ì”© ë”°ë¼ì˜¤ì‹œë©´ ë©ë‹ˆë‹¤!

ìµœì¢… ê²°ê³¼ë¬¼ì€ ì‚¬ìš©ìê°€ ì§ì ‘ `credentials.json` íŒŒì¼ì„ ë§Œë“¤ê±°ë‚˜ ì„ íƒí•  í•„ìš” ì—†ì´, í”„ë¡œê·¸ë¨ ì‹¤í–‰ í›„ ëœ¨ëŠ” êµ¬ê¸€ ë¡œê·¸ì¸ ì°½ì—ì„œ 'í—ˆìš©'ë§Œ í´ë¦­í•˜ë©´ ë˜ë„ë¡ ë§Œë“œëŠ” ê²ƒì…ë‹ˆë‹¤.

í•µì‹¬ ìš©ì–´ëŠ” ì´ˆë“±í•™ìƒë„ ì´í•´í•  ìˆ˜ ìˆê²Œ í’€ì–´ì„œ ì„¤ëª…í•´ ë“œë¦´ê²Œìš”. ì, ì‹œì‘í•´ë³¼ê¹Œìš”?

---

### 1ë‹¨ê³„: ëª©í‘œ ì´í•´í•˜ê¸° ë° ê°œë… ì •ë¦¬

ìš°ë¦¬ê°€ í•˜ë ¤ëŠ” ê²ƒì€ ë¬´ì—‡ì´ê³ , ì™œ í•„ìš”í• ê¹Œìš”?

**ğŸ¤” í˜„ì¬ ë¬¸ì œì :**
*   í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ì‚¬ëŒì´ ê°ì êµ¬ê¸€ í´ë¼ìš°ë“œ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ê³ , APIë¥¼ í™œì„±í™”í•˜ê³ , `credentials.json` íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ ë°›ì•„ì„œ í”„ë¡œê·¸ë¨ì— ë“±ë¡í•´ì•¼ í•©ë‹ˆë‹¤.
*   ê°œë°œìê°€ ì•„ë‹Œ ì¼ë°˜ ì‚¬ìš©ìì—ê²ŒëŠ” ì´ ê³¼ì •ì´ ë„ˆë¬´ ë³µì¡í•˜ê³  ì–´ë µìŠµë‹ˆë‹¤. (ë§ˆì¹˜ ê²Œì„ì„ í•˜ë ¤ë©´ ê²Œì„ê¸°ë¥¼ ì§ì ‘ ì¡°ë¦½í•˜ë¼ê³  í•˜ëŠ” ê²ƒê³¼ ê°™ì•„ìš”!)

**âœ¨ ê°œì„  ëª©í‘œ:**
*   ê°œë°œìê°€ ë¯¸ë¦¬ `credentials.json` íŒŒì¼(í”„ë¡œê·¸ë¨ ì‹ ë¶„ì¦)ì„ ë§Œë“¤ì–´ í”„ë¡œê·¸ë¨ ì•ˆì— 'í¬í•¨'(ë²ˆë“¤ë§)ì‹œì¼œ ë°°í¬í•©ë‹ˆë‹¤.
*   ì‚¬ìš©ìëŠ” í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ê³ , ë¸Œë¼ìš°ì €ì—ì„œ ë³¸ì¸ì˜ êµ¬ê¸€ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ í›„ "ì´ í”„ë¡œê·¸ë¨ì´ ë‚´ êµ¬ê¸€ ë¬¸ì„œì— ì ‘ê·¼í•˜ëŠ” ê²ƒì„ í—ˆë½í•©ë‹ˆë‹¤" ë²„íŠ¼ë§Œ ëˆ„ë¥´ë©´ ë©ë‹ˆë‹¤.
*   ì‚¬ìš©ìëŠ” `credentials.json` íŒŒì¼ì˜ ì¡´ì¬ì¡°ì°¨ ëª°ë¼ë„ ë©ë‹ˆë‹¤! (ê°œë°œìê°€ ë¯¸ë¦¬ ì¡°ë¦½í•´ë‘” ê²Œì„ê¸°ë¥¼ ë°›ì•„ì„œ, ì „ì›ë§Œ ì¼œê³  ë¡œê·¸ì¸í•´ì„œ ë°”ë¡œ ê²Œì„í•˜ëŠ” ê²ƒê³¼ ê°™ì•„ìš”!)

**âœ… í•µì‹¬ ìš©ì–´ ì‰½ê²Œ ì•Œê¸°:**

1.  **Google API (êµ¬ê¸€ ì—ì´í”¼ì•„ì´):**
    *   ìš°ë¦¬ í”„ë¡œê·¸ë¨ì´ êµ¬ê¸€ ë¬¸ì„œ(Google Docs)ì™€ ì„œë¡œ ëŒ€í™”í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” 'í†µì—­ì‚¬' ë˜ëŠ” 'ì—°ê²° í†µë¡œ'ì…ë‹ˆë‹¤. êµ¬ê¸€ ë¬¸ì„œì—ê²Œ "ì´ ë‚´ìš© ì¢€ ì¨ì¤˜!"ë¼ê³  ë¶€íƒí•˜ë ¤ë©´ APIë¥¼ í†µí•´ì•¼ í•´ìš”.
2.  **OAuth 2.0 (ì˜¤ì–´ìŠ¤ 2.0):**
     *    ì•ˆì „í•œ 'ì¶œì… í—ˆê°€' ì ˆì°¨ì…ë‹ˆë‹¤. ìš°ë¦¬ í”„ë¡œê·¸ë¨ì´ ì‚¬ìš©ì ëŒ€ì‹  ì‚¬ìš©ìì˜ êµ¬ê¸€ ë¬¸ì„œì— ì ‘ê·¼í•´ì•¼ í•˜ëŠ”ë°, ì‚¬ìš©ì ëª°ë˜ ì ‘ê·¼í•˜ë©´ ì•ˆ ë˜ê² ì£ ? ì‚¬ìš©ìì—ê²Œ ì§ì ‘ "ì´ í”„ë¡œê·¸ë¨ì´ ë‹¹ì‹ ì˜ êµ¬ê¸€ ë¬¸ì„œì— ì ‘ê·¼í•´ë„ ë ê¹Œìš”?"ë¼ê³  ë¬¼ì–´ë³´ê³  'í—ˆë½'ì„ ë°›ëŠ” ì•ˆì „í•œ ê³¼ì •ì…ë‹ˆë‹¤.
3.  **`credentials.json` (í¬ë ˆë´ì…œ.json / ìê²©ì¦ëª… íŒŒì¼):**
    *   ìš°ë¦¬ **'í”„ë¡œê·¸ë¨'ì˜ ì‹ ë¶„ì¦**ì…ë‹ˆë‹¤. êµ¬ê¸€ì—ê²Œ "ì•ˆë…•í•˜ì„¸ìš”, ì €ëŠ” XXX ë¼ëŠ” í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤." ë¼ê³  ìì‹ ì„ ì†Œê°œí•˜ëŠ” íŒŒì¼ì…ë‹ˆë‹¤.
    *   **ì¤‘ìš”:** ì´ê²ƒì€ ì‚¬ìš©ìì˜ ì‹ ë¶„ì¦ì´ ì•„ë‹ˆë¼, 'í”„ë¡œê·¸ë¨ ìì²´'ì˜ ì‹ ë¶„ì¦ì…ë‹ˆë‹¤.
    *   ê°œë°œìê°€ ë”± í•œ ë²ˆ ë§Œë“¤ì–´ì„œ í”„ë¡œê·¸ë¨ì— ë„£ì–´ë‘¡ë‹ˆë‹¤.
4.  **`token.json` (í† í°.json / ì¸ì¦ í† í° íŒŒì¼):**
    *   **ì‚¬ìš©ìì˜ 'ì¶œì… í—ˆê°€ì¦'** ì…ë‹ˆë‹¤.
    *   ì‚¬ìš©ìê°€ ë¸Œë¼ìš°ì €ì—ì„œ ë¡œê·¸ì¸í•˜ê³  'í—ˆë½' ë²„íŠ¼ì„ ëˆ„ë¥´ë©´, êµ¬ê¸€ì´ ë°œê¸‰í•´ ì£¼ëŠ” ì„ì‹œ ì¶œì…ì¦ì…ë‹ˆë‹¤.
    *   í”„ë¡œê·¸ë¨ì€ ì´ `token.json` (ì¶œì… í—ˆê°€ì¦)ì„ ê°€ì§€ê³  ìˆì–´ì•¼ë§Œ ì‚¬ìš©ìì˜ êµ¬ê¸€ ë¬¸ì„œì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    *   ì´ íŒŒì¼ì€ í”„ë¡œê·¸ë¨ì— í¬í•¨ë˜ì§€ ì•Šê³ , ê° ì‚¬ìš©ì ì»´í“¨í„°ì˜ ì•ˆì „í•œ ì¥ì†Œì— ë”°ë¡œ ì €ì¥ë©ë‹ˆë‹¤. (ì‚¬ìš©ìë§ˆë‹¤ ì¶œì… í—ˆê°€ì¦ì€ ë‹¬ë¼ì•¼ í•˜ë‹ˆê¹Œìš”!)
5.  **Scope (ìŠ¤ì½”í”„ / ê¶Œí•œ ë²”ìœ„):**
    *   í”„ë¡œê·¸ë¨ì´ ì‚¬ìš©ì ëŒ€ì‹  í•  ìˆ˜ ìˆëŠ” ì¼ì˜ 'ë²”ìœ„'ì…ë‹ˆë‹¤. "êµ¬ê¸€ ë¬¸ì„œ ì½ê¸°/ì“°ê¸°ë§Œ í—ˆìš©", "êµ¬ê¸€ ë©”ì¼ ì½ê¸°ëŠ” ë¶ˆí—ˆ" ì²˜ëŸ¼ ì–´ë””ê¹Œì§€ í—ˆë½í• ì§€ ì •í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
6.   **ë²ˆë“¤ë§ (Bundling):**
	*   í”„ë¡œê·¸ë¨ ì‹¤í–‰ íŒŒì¼, ì•„ì´ì½˜, ì„¤ì • íŒŒì¼, ê·¸ë¦¬ê³  `credentials.json` ê°™ì€ í•„ìš”í•œ íŒŒì¼ë“¤ì„ ëª¨ë‘ ëª¨ì•„ í•˜ë‚˜ì˜ ê¾¸ëŸ¬ë¯¸ë¡œ 'í¬ì¥'í•˜ëŠ” ì‘ì—…ì…ë‹ˆë‹¤. ì‚¬ìš©ìëŠ” ì´ í¬ì¥ëœ ê²ƒ í•˜ë‚˜ë§Œ ë°›ì•„ì„œ ì‹¤í–‰í•˜ë©´ ë©ë‹ˆë‹¤. (ì˜ˆ: PyInstaller)

**ğŸ‘ ê°œì„  ë°©ì‹ì˜ íë¦„:**
í”„ë¡œê·¸ë¨ ì‹¤í–‰ â¡ï¸ ì‚¬ìš©ì ì»´í“¨í„°ì— `token.json`(ì¶œì… í—ˆê°€ì¦)ì´ ìˆëŠ”ì§€ í™•ì¸ â¡ï¸
*   **ì—†ê±°ë‚˜ ë§Œë£Œë¨:** í”„ë¡œê·¸ë¨ì— í¬í•¨ëœ `credentials.json`(í”„ë¡œê·¸ë¨ ì‹ ë¶„ì¦) ì‚¬ìš© â¡ï¸ ë¸Œë¼ìš°ì € ì—´ë¦¼ â¡ï¸ ì‚¬ìš©ì ë¡œê·¸ì¸ ë° í—ˆë½ â¡ï¸ êµ¬ê¸€ì´ `token.json`(ì¶œì… í—ˆê°€ì¦) ë°œê¸‰ â¡ï¸ ì‚¬ìš©ì ì»´í“¨í„°ì— `token.json` ì €ì¥ â¡ï¸ ì¶œì… í—ˆê°€ì¦ìœ¼ë¡œ êµ¬ê¸€ ë¬¸ì„œ ì ‘ê·¼!
*   **ìˆê³  ìœ íš¨í•¨:** ì €ì¥ëœ `token.json`(ì¶œì… í—ˆê°€ì¦)ì„ ë°”ë¡œ ì‚¬ìš© â¡ï¸ êµ¬ê¸€ ë¬¸ì„œ ì ‘ê·¼! (ë‹¤ì‹œ ë¡œê·¸ì¸/í—ˆë½ í•„ìš” ì—†ìŒ)

---

### 2ë‹¨ê³„: ì‚¬ì „ ì¤€ë¹„ (ê°œë°œìê°€ í•  ì¼)

ì½”ë“œë¥¼ ìˆ˜ì •í•˜ê¸° ì „ì— ë”± í•œ ê°€ì§€, ê°œë°œìê°€ í•´ì•¼ í•  ì¼ì´ ìˆìŠµë‹ˆë‹¤.

1.  **Google Cloud Console ì ‘ì†:** [https://console.cloud.google.com/](https://console.cloud.google.com/)
2.  **í”„ë¡œì íŠ¸ ì„ íƒ ë˜ëŠ” ìƒì„±:** APIë¥¼ ì‚¬ìš©í•  í”„ë¡œì íŠ¸ë¥¼ ë§Œë“­ë‹ˆë‹¤.
3.  **API ë° ì„œë¹„ìŠ¤ í™œì„±í™”:** 'API ë° ì„œë¹„ìŠ¤' > 'ë¼ì´ë¸ŒëŸ¬ë¦¬' ì—ì„œ `Google Docs API`ë¥¼ ì°¾ì•„ 'ì‚¬ìš© ì„¤ì •' í•©ë‹ˆë‹¤.
4.  **OAuth ë™ì˜ í™”ë©´ êµ¬ì„±:** ì‚¬ìš©ìì—ê²Œ í—ˆë½ì„ êµ¬í•  ë•Œ ë³´ì—¬ì¤„ í™”ë©´(ì•± ì´ë¦„, ë¡œê³  ë“±)ì„ ì„¤ì •í•©ë‹ˆë‹¤.
5.  **ì‚¬ìš©ì ì¸ì¦ ì •ë³´ ë§Œë“¤ê¸°:**
    *   'API ë° ì„œë¹„ìŠ¤' > 'ì‚¬ìš©ì ì¸ì¦ ì •ë³´' > '+ ì‚¬ìš©ì ì¸ì¦ ì •ë³´ ë§Œë“¤ê¸°' > 'OAuth í´ë¼ì´ì–¸íŠ¸ ID' ì„ íƒ
    *   **ì• í”Œë¦¬ì¼€ì´ì…˜ ìœ í˜•:** â­**ë°ìŠ¤í¬í†± ì•±**â­ ì„ ë°˜ë“œì‹œ ì„ íƒí•©ë‹ˆë‹¤. (ê°€ì¥ ì¤‘ìš”!)
    *   ì´ë¦„ ì…ë ¥ í›„ 'ë§Œë“¤ê¸°' í´ë¦­.
6.  **`credentials.json` ë‹¤ìš´ë¡œë“œ:**
    *   ìƒì„±ëœ 'ë°ìŠ¤í¬í†± ì•±' í´ë¼ì´ì–¸íŠ¸ ID ëª©ë¡ì—ì„œ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼(â¬‡ï¸)ì„ ëˆŒëŸ¬ JSON íŒŒì¼ì„ ë°›ìŠµë‹ˆë‹¤.
7.  **íŒŒì¼ ì´ë¦„ ë³€ê²½ ë° ë°°ì¹˜:**
    *   ë‹¤ìš´ë¡œë“œí•œ íŒŒì¼ ì´ë¦„ì„ `developer_credentials.json` ìœ¼ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.
    *   í”„ë¡œì íŠ¸ í´ë” ì•ˆì— `src/auto_write_txt_to_docs/assets/` í´ë”ë¥¼ ë§Œë“¤ê³ , ê·¸ ì•ˆì— `developer_credentials.json` íŒŒì¼ì„ ë„£ìŠµë‹ˆë‹¤.
    ```
     (í”„ë¡œì íŠ¸ ë£¨íŠ¸)
     â””â”€â”€ src
         â””â”€â”€ auto_write_txt_to_docs
             â”œâ”€â”€ assets  <-- ì´ í´ë” ìƒì„±
             â”‚   â””â”€â”€ developer_credentials.json  <-- ì—¬ê¸°ì— íŒŒì¼ ë„£ê¸°!
             â”œâ”€â”€ __init__.py
             â”œâ”€â”€ backend_processor.py
             â”œâ”€â”€ google_auth.py
             â”œâ”€â”€ main_gui.py
             â””â”€â”€ path_utils.py
    ```

ì´ì œ í”„ë¡œê·¸ë¨ì˜ 'ì‹ ë¶„ì¦' ì¤€ë¹„ê°€ ëë‚¬ìŠµë‹ˆë‹¤! ì½”ë“œë¥¼ ìˆ˜ì •í•˜ëŸ¬ ê°€ë³¼ê¹Œìš”?

---

### 3ë‹¨ê³„: ì½”ë“œ ìˆ˜ì • - `path_utils.py` (ì£¼ì†Œ ì•Œë ¤ì£¼ê¸°)

í”„ë¡œê·¸ë¨ì—ê²Œ ìƒˆë¡œ ë„£ì–´ë‘” `developer_credentials.json` íŒŒì¼(í”„ë¡œê·¸ë¨ ì‹ ë¶„ì¦)ì´ ì–´ë”” ìˆëŠ”ì§€ ì •í™•í•œ 'ì£¼ì†Œ'ë¥¼ ì•Œë ¤ì¤˜ì•¼ í•©ë‹ˆë‹¤.

*   **ëª©í‘œ:** `developer_credentials.json` íŒŒì¼ì˜ ê²½ë¡œë¥¼ ì°¾ì•„ì£¼ëŠ” í•¨ìˆ˜ ë§Œë“¤ê¸°. (ê°œë°œ í™˜ê²½ê³¼, ë‚˜ì¤‘ì— exe íŒŒì¼ë¡œ í¬ì¥(ë²ˆë“¤ë§)í–ˆì„ ë•Œ ëª¨ë‘ ì‘ë™í•˜ë„ë¡!)

```python
# path_utils.py
import sys
import os
from pathlib import Path
import logging

# --- ê¸°ì¡´ ì½”ë“œ ì‹œì‘ (ì˜ˆì‹œ) ---
# í”„ë¡œì íŠ¸ì˜ ê°€ì¥ ê¼­ëŒ€ê¸° í´ë”(ë£¨íŠ¸) ì£¼ì†Œë¥¼ ì°¾ëŠ” í•¨ìˆ˜
def get_project_root() -> Path:
     """í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ ê²½ë¡œë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤."""
     # í˜„ì¬ íŒŒì¼(__file__) ê¸°ì¤€ìœ¼ë¡œ ìœ„ë¡œ ì˜¬ë¼ê°€ì„œ ë£¨íŠ¸ ì°¾ê¸°
     return Path(__file__).parent.parent.parent

# ì‚¬ìš©ìë³„ ì„¤ì •/ìºì‹œ íŒŒì¼ì„ ì €ì¥í•  ì•ˆì „í•œ í´ë” ì£¼ì†Œë¥¼ ì°¾ëŠ” í•¨ìˆ˜ (ì˜ˆ: C:\Users\ì‚¬ìš©ìì´ë¦„\AppData\Roaming\í”„ë¡œê·¸ë¨ì´ë¦„)
def get_user_config_dir(app_name="MessengerDocsAutoWriter") -> Path:
     """ìš´ì˜ì²´ì œì— ë§ëŠ” ì‚¬ìš©ìë³„ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°ì´í„° ë””ë ‰í† ë¦¬ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤."""
     if sys.platform == "win32":
         base_dir = Path(os.environ.get("APPDATA", Path.home()))
     elif sys.platform == "darwin": # macOS
         base_dir = Path.home() / "Library" / "Application Support"
     else: # Linux / other
         base_dir = Path(os.environ.get("XDG_CONFIG_HOME", Path.home() / ".config"))
     config_dir = base_dir / app_name
     try:
         config_dir.mkdir(parents=True, exist_ok=True) # í´ë”ê°€ ì—†ìœ¼ë©´ ë§Œë“¤ê¸°
     except OSError as e:
         logging.warning(f"ì‚¬ìš©ì ì„¤ì • ë””ë ‰í† ë¦¬ ìƒì„± ì‹¤íŒ¨ ({config_dir}): {e}. ê¸°ë³¸ ê²½ë¡œ ì‚¬ìš©.")
         return get_project_root() # ì‹¤íŒ¨ ì‹œ í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë°˜í™˜
     return config_dir

# ì„¤ì • íŒŒì¼ì„ ì–´ë”” ì €ì¥í• ì§€ ê²°ì •í•˜ëŠ” í•¨ìˆ˜
def get_safe_config_path(filename="config.json", use_user_dir=True) -> Path:
    """ì„¤ì • íŒŒì¼ì˜ ì•ˆì „í•œ ê²½ë¡œë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤."""
    if use_user_dir:
        return get_user_config_dir() / filename
    else:
         # ì‚¬ìš©ì í´ë”ë¥¼ ì•ˆ ì“°ë©´ í”„ë¡œê·¸ë¨ í´ë”ì— ì €ì¥ (ê¶Œì¥ ì•ˆ í•¨)
        return get_project_root() / filename

# ìºì‹œ íŒŒì¼(token.json, cache.json ë“±)ì„ ì–´ë”” ì €ì¥í• ì§€ ê²°ì •í•˜ëŠ” í•¨ìˆ˜
def get_safe_cache_path(filename="cache.json", use_user_dir=True) -> Path:
    """ìºì‹œ íŒŒì¼ì˜ ì•ˆì „í•œ ê²½ë¡œë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. token.json ë“±ì— ì‚¬ìš©."""
    if use_user_dir:
        # ì‚¬ìš©ìë³„ í´ë” ì•„ë˜ cache ì„œë¸Œ í´ë” ì‚¬ìš©
        cache_dir = get_user_config_dir() / "cache"
        try:
            cache_dir.mkdir(parents=True, exist_ok=True)
        except OSError:
             # ì‹¤íŒ¨ ì‹œ ì‚¬ìš©ì í´ë” ë°”ë¡œ ì•„ë˜ ì €ì¥
             return get_user_config_dir() / filename
        return cache_dir / filename
    else:
        return get_project_root() / filename
# --- ê¸°ì¡´ ì½”ë“œ ë ---


# â­â­â­ ì•„ë˜ ì½”ë“œ ì¶”ê°€ â­â­â­
# ê°œë°œì ìê²© ì¦ëª… íŒŒì¼(í”„ë¡œê·¸ë¨ ì‹ ë¶„ì¦) ê²½ë¡œ ì°¾ê¸°
def get_bundled_credentials_path(filename="developer_credentials.json"):
    """
    í”„ë¡œê·¸ë¨ì— í¬í•¨ëœ(ë²ˆë“¤ë§ëœ) ê°œë°œì ìê²© ì¦ëª… íŒŒì¼(credentials.json)ì˜ ì£¼ì†Œë¥¼ ì•Œë ¤ì¤ë‹ˆë‹¤.
    """
    # PyInstaller ë“±ìœ¼ë¡œ exe íŒŒì¼ì„ ë§Œë“¤ë©´, sys._MEIPASS ë¼ëŠ” íŠ¹ë³„í•œ ì„ì‹œ í´ë” ì£¼ì†Œê°€ ìƒê¹ë‹ˆë‹¤.
    if getattr(sys, 'frozen', False) and hasattr(sys, '_MEIPASS'):
        # ì‹¤í–‰ íŒŒì¼(exe)ë¡œ ì‹¤í–‰ ì¤‘ì¸ ê²½ìš°:
        # PyInstaller ë¡œ í¬ì¥í•  ë•Œ assets í´ë”ë¥¼ í¬í•¨ì‹œì¼°ë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.
        # ì˜ˆ: PyInstaller ì‹¤í–‰ ì‹œ --add-data "src/auto_write_txt_to_docs/assets:assets" ì˜µì…˜ ì‚¬ìš©
        print("ì‹¤í–‰ íŒŒì¼ í™˜ê²½: ë²ˆë“¤ëœ ì¸ì¦ì„œ ê²½ë¡œ íƒìƒ‰")
        base_path = Path(sys._MEIPASS)
        return base_path / "assets" / filename
    else:
        # ê°œë°œ í™˜ê²½ (.py íŒŒì¼ì„ ì§ì ‘ ì‹¤í–‰í•˜ëŠ” ê²½ìš°):
        # í”„ë¡œì íŠ¸ ë£¨íŠ¸/src/auto_write_txt_to_docs/assets/developer_credentials.json ì£¼ì†Œë¥¼ ì°¾ìŠµë‹ˆë‹¤.
        print("ê°œë°œ í™˜ê²½: ì†ŒìŠ¤ì½”ë“œ ê¸°ì¤€ ì¸ì¦ì„œ ê²½ë¡œ íƒìƒ‰")
        base_path = get_project_root()
        return base_path / "src" / "auto_write_txt_to_docs" / "assets" / filename

# --- ê¸°ì¡´ ì½”ë“œ (í™˜ê²½ ë³€ìˆ˜ ë° ê¸°ë³¸ ì„¤ì •) ìœ ì§€ ---
PROJECT_ROOT = get_project_root()
CONFIG_FILE = get_safe_config_path("config.json", use_user_dir=True) # ì„¤ì • íŒŒì¼ì€ ì‚¬ìš©ì í´ë”ì—
CACHE_FILE = get_safe_cache_path("line_cache.json", use_user_dir=True) # ìºì‹œ íŒŒì¼ë„ ì‚¬ìš©ì í´ë”ì—
PROCESSED_STATE_FILE = get_safe_cache_path("processed_state.json", use_user_dir=True) # ì²˜ë¦¬ ìƒíƒœë„ ì‚¬ìš©ì í´ë”ì—
LOG_DIR = PROJECT_ROOT / "logs" # ë¡œê·¸ëŠ” í”„ë¡œê·¸ë¨ í´ë”ì— (ë˜ëŠ” ì‚¬ìš©ì í´ë”ë¡œ ë³€ê²½ ê°€ëŠ¥)

# ë‹¤ë¥¸ íŒŒì¼ì—ì„œ ì‰½ê²Œ ì“°ê¸° ìœ„í•´ ë¬¸ìì—´(str) ë²„ì „ë„ ë§Œë“¦
PROJECT_ROOT_STR = str(PROJECT_ROOT)
CONFIG_FILE_STR = str(CONFIG_FILE)
CACHE_FILE_STR = str(CACHE_FILE)
PROCESSED_STATE_FILE_STR = str(PROCESSED_STATE_FILE)
LOG_DIR_STR = str(LOG_DIR)

# â­â­â­ ì•„ë˜ ì½”ë“œ ì¶”ê°€ â­â­â­
# í”„ë¡œê·¸ë¨ ì‹ ë¶„ì¦ íŒŒì¼ì˜ ìµœì¢… ì£¼ì†Œ (ë¬¸ìì—´ ë²„ì „)
BUNDLED_CREDENTIALS_FILE_STR = str(get_bundled_credentials_path())
# token.json (ì‚¬ìš©ì ì¶œì… í—ˆê°€ì¦) ì €ì¥ ê²½ë¡œë„ ëª…í™•íˆ ì •ì˜ (google_auth.py ì—ì„œ ì‚¬ìš©)
TOKEN_FILE_PATH = get_safe_cache_path("token.json", use_user_dir=True) # â­token.jsonì€ ë°˜ë“œì‹œ ì‚¬ìš©ì í´ë”ì—!â­
TOKEN_FILE_STR = str(TOKEN_FILE_PATH)
```
**ğŸ’¡ ì„¤ëª…:**
*   `get_bundled_credentials_path` í•¨ìˆ˜ë¥¼ ìƒˆë¡œ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.
*   ì´ í•¨ìˆ˜ëŠ” í”„ë¡œê·¸ë¨ì´ `.py`ë¡œ ì‹¤í–‰ ì¤‘ì¸ì§€, ì•„ë‹ˆë©´ `.exe` íŒŒì¼ë¡œ ë¬¶ì—¬ì„œ(ë²ˆë“¤ë§ë˜ì–´) ì‹¤í–‰ ì¤‘ì¸ì§€ë¥¼ í™•ì¸(`sys._MEIPASS`)í•©ë‹ˆë‹¤.
*   ê° ìƒí™©ì— ë§ê²Œ `developer_credentials.json` íŒŒì¼ì´ ìˆëŠ” ì •í™•í•œ 'ì£¼ì†Œ'ë¥¼ ì°¾ì•„ì„œ ëŒë ¤ì¤ë‹ˆë‹¤.
*   `BUNDLED_CREDENTIALS_FILE_STR` ë³€ìˆ˜ì— ì´ ì£¼ì†Œë¥¼ ì €ì¥í•´ì„œ ë‹¤ë¥¸ íŒŒì¼ë“¤ì´ ì‰½ê²Œ ê°€ì ¸ë‹¤ ì“¸ ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.
*   `token.json`(ì‚¬ìš©ì ì¶œì… í—ˆê°€ì¦)ì€ í”„ë¡œê·¸ë¨ í´ë”ê°€ ì•„ë‹Œ, ê° ì‚¬ìš©ìì˜ ê°œì¸ í´ë”(`AppData` ë“±)ì— ì•ˆì „í•˜ê²Œ ì €ì¥ë˜ë„ë¡ `get_safe_cache_path("token.json", use_user_dir=True)`ë¥¼ ì‚¬ìš©í•˜ê³  `TOKEN_FILE_STR` ë³€ìˆ˜ì— ì €ì¥í–ˆìŠµë‹ˆë‹¤.

---

### 4ë‹¨ê³„: ì½”ë“œ ìˆ˜ì • - `google_auth.py` (ì‹ ë¶„ì¦ ì‚¬ìš©í•˜ê¸°)

ì´ì œ ì¸ì¦ì„ ë‹´ë‹¹í•˜ëŠ” íŒŒì¼ì—ì„œ, GUIë¡œë¶€í„° ê²½ë¡œë¥¼ ì…ë ¥ë°›ëŠ” ëŒ€ì‹  `path_utils.py`ê°€ ì•Œë ¤ì¤€ 'ì£¼ì†Œ'ì— ìˆëŠ” í”„ë¡œê·¸ë¨ ì‹ ë¶„ì¦ íŒŒì¼ì„ ì‚¬ìš©í•˜ë„ë¡ ìˆ˜ì •í•©ë‹ˆë‹¤.

*   **ëª©í‘œ:**
    *   `authenticate` í•¨ìˆ˜ ë“±ì—ì„œ `credentials_path` ì¸ì(íŒŒë¼ë¯¸í„°) ì œê±°.
    *   `path_utils`ì—ì„œ ì •ì˜í•œ `BUNDLED_CREDENTIALS_FILE_STR` (í”„ë¡œê·¸ë¨ ì‹ ë¶„ì¦ ì£¼ì†Œ)ì™€ `TOKEN_FILE_STR` (ì‚¬ìš©ì ì¶œì… í—ˆê°€ì¦ ì£¼ì†Œ) ì‚¬ìš©.

```python
# google_auth.py
import os
import json
import logging
from datetime import datetime
# êµ¬ê¸€ ì¸ì¦ ê´€ë ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤
from google.auth.transport.requests import Request
from google.oauth2.credentials import Credentials
from google_auth_oauthlib.flow import InstalledAppFlow
from googleapiclient.discovery import build
from googleapiclient.errors import HttpError

# â­ path_utils ì—ì„œ í•„ìš”í•œ ì£¼ì†Œ ì •ë³´ ê°€ì ¸ì˜¤ê¸° â­
try:
    # BUNDLED_CREDENTIALS_FILE_STR: í”„ë¡œê·¸ë¨ ì‹ ë¶„ì¦ ì£¼ì†Œ
    # TOKEN_FILE_STR: ì‚¬ìš©ì ì¶œì… í—ˆê°€ì¦ ì €ì¥ ì£¼ì†Œ
    from .path_utils import BUNDLED_CREDENTIALS_FILE_STR, TOKEN_FILE_STR
except ImportError:
    # path_utils íŒŒì¼ì´ ì—†ëŠ” ë¹„ìƒ ìƒí™© ëŒ€ë¹„
    print("ì˜¤ë¥˜: path_utils.py íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. Google ì¸ì¦ì´ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.")
    BUNDLED_CREDENTIALS_FILE_STR = None
    TOKEN_FILE_STR = 'token.json' # ì„ì‹œ ê²½ë¡œ

# í”„ë¡œê·¸ë¨ì´ êµ¬ê¸€ ë¬¸ì„œì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ 'ê¶Œí•œ ë²”ìœ„(Scope)' ì„¤ì •
SCOPES = ['https://www.googleapis.com/auth/documents']

# ë¡œê¹… ì„¤ì • (ê·¸ëŒ€ë¡œ ìœ ì§€)
def setup_google_auth_logging():
     logger = logging.getLogger('google_auth')
     if not logger.hasHandlers():
        # íŒŒì¼ ë° ì½˜ì†” í•¸ë“¤ëŸ¬ ì„¤ì • (ê¸°ì¡´ ì½”ë“œ ë‚´ìš©)
        pass
     logger.setLevel(logging.INFO)
     return logger

# â­ credentials_path ì¸ì ì œê±° â­
def authenticate(log_func):
    """
    Google API ì¸ì¦ì„ ìˆ˜í–‰í•˜ê³  'ì¶œì… í—ˆê°€ì¦'(Credentials ê°ì²´)ì„ ëŒë ¤ì¤ë‹ˆë‹¤.
    - ì‚¬ìš©ì ì»´í“¨í„°ì— ìœ íš¨í•œ token.json(ì¶œì… í—ˆê°€ì¦)ì´ ìˆìœ¼ë©´ ê·¸ê²ƒì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
    - ì—†ê±°ë‚˜ ë§Œë£Œë˜ì—ˆìœ¼ë©´, í”„ë¡œê·¸ë¨ì— í¬í•¨ëœ credentials.json(ì‹ ë¶„ì¦)ì„ ì´ìš©í•´
      ì‚¬ìš©ìì—ê²Œ ë¸Œë¼ìš°ì €ë¡œ í—ˆë½ì„ ë°›ê³  ìƒˆ token.jsonì„ ë°œê¸‰ë°›ì•„ ì €ì¥í•©ë‹ˆë‹¤.
    """
    auth_logger = logging.getLogger('google_auth')
    creds = None # ì¶œì… í—ˆê°€ì¦ì„ ë‹´ì„ ë³€ìˆ˜ ì´ˆê¸°í™”

    # â­ 1. í”„ë¡œê·¸ë¨ ì‹ ë¶„ì¦ íŒŒì¼ ì£¼ì†Œ ê°€ì ¸ì˜¤ê¸° (path_utilsì—ì„œ) â­
    credentials_path = BUNDLED_CREDENTIALS_FILE_STR
    # â­ 2. ì‚¬ìš©ì ì¶œì… í—ˆê°€ì¦ ì €ì¥ íŒŒì¼ ì£¼ì†Œ ê°€ì ¸ì˜¤ê¸° (path_utilsì—ì„œ) â­
    token_path = TOKEN_FILE_STR

    # ì‹ ë¶„ì¦ íŒŒì¼ì´ ì‹¤ì œë¡œ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
    if not credentials_path or not os.path.exists(credentials_path):
         error_msg = f"ì˜¤ë¥˜: í”„ë¡œê·¸ë¨ì— í¬í•¨ëœ ì¸ì¦ íŒŒì¼({credentials_path})ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê°œë°œìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”."
         log_func(error_msg)
         auth_logger.error(error_msg)
         return None # ì‹ ë¶„ì¦ ì—†ì´ëŠ” ì§„í–‰ ë¶ˆê°€

    auth_logger.info(f"ì¸ì¦ ì‹œì‘ - í† í° ê²½ë¡œ: {token_path}, ì‹ ë¶„ì¦ ê²½ë¡œ: {credentials_path}")
    log_func(f"ë°±ì—”ë“œ: Google ì¸ì¦ í™•ì¸ ì¤‘... (í† í° ì €ì¥ì†Œ: {token_path})")

    # â­ 3. ê¸°ì¡´ ì¶œì… í—ˆê°€ì¦(token.json)ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ê³  ë¶ˆëŸ¬ì˜¤ê¸° â­
    if os.path.exists(token_path):
        try:
            # íŒŒì¼ì—ì„œ ì¶œì… í—ˆê°€ì¦ ì •ë³´ ë¡œë“œ (ê¶Œí•œ ë²”ìœ„ SCOPESë„ ë§ëŠ”ì§€ í™•ì¸)
            creds = Credentials.from_authorized_user_file(token_path, SCOPES)
            log_func("ë°±ì—”ë“œ: ì €ì¥ëœ Google ì‚¬ìš©ì ì¸ì¦ ì •ë³´(í† í°) ë¡œë“œ ì„±ê³µ.")
            auth_logger.info("ê¸°ì¡´ í† í° íŒŒì¼ ë¡œë“œ ì„±ê³µ")
        except Exception as e:
            log_func(f"ê²½ê³ : ê¸°ì¡´ ì¸ì¦ ì •ë³´(í† í°) íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨: {e}. ë‹¤ì‹œ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.")
            auth_logger.warning(f"ê¸°ì¡´ í† í° íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨: {e}")
            creds = None # ì‹¤íŒ¨ ì‹œ ì—†ëŠ” ê²ƒìœ¼ë¡œ ê°„ì£¼

    # â­ 4. ì¶œì… í—ˆê°€ì¦ì´ ì—†ê±°ë‚˜, ìˆë”ë¼ë„ ìœ íš¨í•˜ì§€ ì•Šì€ ê²½ìš° ì²˜ë¦¬ â­
    # creds.valid : ì¶œì… í—ˆê°€ì¦ì´ ìœ íš¨í•œê°€?
    # creds.expired : ì¶œì… í—ˆê°€ì¦ì´ ë§Œë£Œë˜ì—ˆëŠ”ê°€?
    # creds.refresh_token : ë§Œë£Œ ì‹œ ê°±ì‹ í•  ìˆ˜ ìˆëŠ” íŠ¹ë³„í•œ í† í°ì´ ìˆëŠ”ê°€?
    if not creds or not creds.valid:
        # 4-1. ë§Œë£Œë˜ì—ˆì§€ë§Œ ê°±ì‹  í† í°ì´ ìˆìœ¼ë©´, ì¡°ìš©íˆ ê°±ì‹  ì‹œë„
        if creds and creds.expired and creds.refresh_token:
            log_func("ë°±ì—”ë“œ: ì¸ì¦ ì •ë³´(í† í°) ë§Œë£Œë¨. ìë™ ê°±ì‹  ì‹œë„...")
            auth_logger.info("í† í° ë§Œë£Œë¨. ê°±ì‹  ì‹œë„.")
            try:
                 creds.refresh(Request()) # ê°±ì‹ !
                 log_func("ë°±ì—”ë“œ: ì¸ì¦ ì •ë³´(í† í°) ê°±ì‹  ì„±ê³µ.")
                 auth_logger.info("í† í° ê°±ì‹  ì„±ê³µ.")
            except Exception as e:
                 log_func(f"ê²½ê³ : ì¸ì¦ ì •ë³´(í† í°) ê°±ì‹  ì‹¤íŒ¨: {e}. ë‹¤ì‹œ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.")
                 auth_logger.warning(f"í† í° ê°±ì‹  ì‹¤íŒ¨: {e}")
                 creds = None # ê°±ì‹  ì‹¤íŒ¨ ì‹œ, ìƒˆë¡œ ë°œê¸‰ë°›ì•„ì•¼ í•¨

        # 4-2. ê°±ì‹ ì— ì‹¤íŒ¨í–ˆê±°ë‚˜, ì• ì´ˆì— ì¶œì… í—ˆê°€ì¦ì´ ì—†ìœ¼ë©´ -> ì‚¬ìš©ì í—ˆë½ë°›ê¸°(ìƒˆ ì¸ì¦)
        if not creds:
            auth_logger.info("ìƒˆë¡œìš´ ì¸ì¦ í”Œë¡œìš° ì‹œì‘ (ì‚¬ìš©ì ë¸Œë¼ìš°ì € í™•ì¸ í•„ìš”)")
            try:
                log_func("ë°±ì—”ë“œ: âš ï¸ Google ê³„ì • ì¸ì¦ í•„ìš”! ì›¹ ë¸Œë¼ìš°ì € ì°½ì„ í™•ì¸í•˜ê³  ë¡œê·¸ ë° ì ‘ê·¼ì„ 'í—ˆìš©' í•´ì£¼ì„¸ìš”. âš ï¸")
                # â­ í”„ë¡œê·¸ë¨ ì‹ ë¶„ì¦(credentials_path)ì„ ì´ìš©í•´ ì‚¬ìš©ì í—ˆë½ ì ˆì°¨(flow) ì‹œì‘ â­
                flow = InstalledAppFlow.from_client_secrets_file(credentials_path, SCOPES)
                # ë¸Œë¼ìš°ì €ë¥¼ ì—´ê³ , ì‚¬ìš©ìê°€ í—ˆë½í•  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼ (port=0 ì€ ì‚¬ìš© ê°€ëŠ¥í•œ ì•„ë¬´ í¬íŠ¸ë‚˜ ì‚¬ìš©)
                creds = flow.run_local_server(port=0)
                log_func("ë°±ì—”ë“œ: âœ… Google ê³„ì • ì‚¬ìš©ì ì¸ì¦ ì„±ê³µ!")
                auth_logger.info("ìƒˆë¡œìš´ ì‚¬ìš©ì ì¸ì¦ ì™„ë£Œ")
            except Exception as e:
                log_func(f"ì˜¤ë¥˜: Google ê³„ì • ì¸ì¦ ì¤‘ ì˜¤ë¥˜ ë°œìƒ - {e}")
                auth_logger.error(f"ìƒˆë¡œìš´ ì¸ì¦ ì‹¤íŒ¨: {e}", exc_info=True)
                return None # ì¸ì¦ ì‹¤íŒ¨

        # â­ 5. ìƒˆë¡œ ë°œê¸‰/ê°±ì‹ ëœ ì¶œì… í—ˆê°€ì¦(creds)ì„ token.json íŒŒì¼ì— ì €ì¥ â­
        # (ë‹¤ìŒì— ì‹¤í–‰í•  ë•ŒëŠ” ë‹¤ì‹œ í—ˆë½ë°›ì§€ ì•Šê¸° ìœ„í•´)
        try:
            # í† í° íŒŒì¼ì´ ì €ì¥ë  í´ë”ê°€ ì—†ìœ¼ë©´ ë§Œë“¤ê¸° (path_utilsê°€ í•´ì£¼ì§€ë§Œ ì•ˆì „í•˜ê²Œ)
            os.makedirs(os.path.dirname(token_path), exist_ok=True)
            with open(token_path, 'w', encoding='utf-8') as token:
                token.write(creds.to_json()) # ì¶œì… í—ˆê°€ì¦ ì •ë³´ë¥¼ JSON í˜•íƒœë¡œ íŒŒì¼ì— ì“°ê¸°
            log_func(f"ë°±ì—”ë“œ: ìƒˆ ì¸ì¦ ì •ë³´(í† í°) ì €ì¥ ì™„ë£Œ: {token_path}")
            auth_logger.info(f"í† í° ì €ì¥ ì™„ë£Œ: {token_path}")
        except Exception as e:
            log_func(f"ê²½ê³ : ìƒˆ ì¸ì¦ ì •ë³´({token_path}) ì €ì¥ ì‹¤íŒ¨ - {e}")
            auth_logger.error(f"í† í° ì €ì¥ ì‹¤íŒ¨: {e}")
    else:
         # 3ë²ˆì—ì„œ ë¡œë“œí•œ ê¸°ì¡´ ì¶œì… í—ˆê°€ì¦ì´ ìœ íš¨í•œ ê²½ìš°
        auth_logger.info("ê¸°ì¡´ í† í°ì´ ìœ íš¨í•¨.")
        log_func("ë°±ì—”ë“œ: ê¸°ì¡´ Google ì¸ì¦ ì •ë³´(í† í°)ê°€ ìœ íš¨í•©ë‹ˆë‹¤.")


    return creds # ìµœì¢…ì ìœ¼ë¡œ ìœ íš¨í•œ ì¶œì… í—ˆê°€ì¦ ë°˜í™˜

# â­ credentials_path ì¸ì ì œê±° â­
def get_google_services(log_func):
    """ ì¸ì¦ì„ ìˆ˜í–‰í•˜ê³ , êµ¬ê¸€ ë¬¸ì„œ ì„œë¹„ìŠ¤ ê°ì²´(API í†µë¡œ)ë¥¼ ë§Œë“¤ì–´ ë°˜í™˜í•©ë‹ˆë‹¤. """
    auth_logger = setup_google_auth_logging()
    auth_logger.info("Google ì„œë¹„ìŠ¤ ìƒì„± ì‹œì‘")

    # â­ authenticate() í•¨ìˆ˜ í˜¸ì¶œ ì‹œ credentials_path ì•ˆ ë„˜ê¹€ â­
    creds = authenticate(log_func) # ìœ„ì—ì„œ ë§Œë“  ì¸ì¦ í•¨ìˆ˜ í˜¸ì¶œ (ì¶œì… í—ˆê°€ì¦ ë°›ì•„ì˜¤ê¸°)
    if not creds:
        # ì¶œì… í—ˆê°€ì¦ ë°›ê¸° ì‹¤íŒ¨
        log_func("ì˜¤ë¥˜: Google API ì¸ì¦ ì‹¤íŒ¨. ì„œë¹„ìŠ¤ ê°ì²´ë¥¼ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
        auth_logger.error("Google API ì¸ì¦ ì‹¤íŒ¨")
        return None

    auth_logger.info("Google ì¸ì¦ ì„±ê³µ, ì„œë¹„ìŠ¤ ê°ì²´ ìƒì„± ì‹œë„")
    services = {}
    try:
        log_func("ë°±ì—”ë“œ: Google Docs ì„œë¹„ìŠ¤ ì—°ê²° ì¤‘...")
        # ë°›ì•„ì˜¨ ì¶œì… í—ˆê°€ì¦(creds)ì„ ì´ìš©í•´ì„œ êµ¬ê¸€ ë¬¸ì„œ ì„œë¹„ìŠ¤ì™€ ì—°ê²° í†µë¡œ(docs) ë§Œë“¤ê¸°
        services['docs'] = build('docs', 'v1', credentials=creds)
        log_func("ë°±ì—”ë“œ: Google Docs ì„œë¹„ìŠ¤ ì—°ê²° ì™„ë£Œ.")
        auth_logger.info("Google Docs ì„œë¹„ìŠ¤ ê°ì²´ ìƒì„± ì™„ë£Œ")
        return services
    except HttpError as error:
        log_func(f"ì˜¤ë¥˜: Google ì„œë¹„ìŠ¤ ì—°ê²° ì¤‘ API ì˜¤ë¥˜ ë°œìƒ - {error}")
        auth_logger.error(f"Google ì„œë¹„ìŠ¤ ê°ì²´ ìƒì„± ì¤‘ API ì˜¤ë¥˜: {error}", exc_info=True)
        return None
    except Exception as e:
        log_func(f"ì˜¤ë¥˜: Google ì„œë¹„ìŠ¤ ì—°ê²° ì¤‘ ì˜ˆì™¸ ë°œìƒ - {e}")
        auth_logger.error(f"Google ì„œë¹„ìŠ¤ ê°ì²´ ìƒì„± ì¤‘ ì˜ˆì™¸: {e}", exc_info=True)
        return None
```
**ğŸ’¡ ì„¤ëª…:**
*   í•¨ìˆ˜ `authenticate`ì™€ `get_google_services`ì—ì„œ `credentials_path`ë¥¼ ì…ë ¥ë°›ëŠ” ë¶€ë¶„ì„ ëª¨ë‘ ì œê±°í–ˆìŠµë‹ˆë‹¤.
*   `path_utils`ì—ì„œ ê°€ì ¸ì˜¨ `BUNDLED_CREDENTIALS_FILE_STR`(ì‹ ë¶„ì¦ ì£¼ì†Œ)ì™€ `TOKEN_FILE_STR`(ì¶œì… í—ˆê°€ì¦ ì£¼ì†Œ)ë¥¼ ì§ì ‘ ì‚¬ìš©í•©ë‹ˆë‹¤.
*   ì‚¬ìš©ì í—ˆë½ì´ í•„ìš”í•œ ê²½ìš°, `InstalledAppFlow.from_client_secrets_file`ì— `credentials_path` (ìš°ë¦¬ê°€ ë„£ì–´ì¤€ í”„ë¡œê·¸ë¨ ì‹ ë¶„ì¦ ì£¼ì†Œ)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ì¦ ì ˆì°¨ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.
*   ì¸ì¦ ì„±ê³µ í›„ ë°œê¸‰ëœ `token.json`(ì¶œì… í—ˆê°€ì¦)ì€ `TOKEN_FILE_STR` ê²½ë¡œ(ì‚¬ìš©ì ê°œì¸ í´ë”)ì— ì•ˆì „í•˜ê²Œ ì €ì¥ë©ë‹ˆë‹¤.

---
### 5ë‹¨ê³„: ì½”ë“œ ìˆ˜ì • - `backend_processor.py` (ì—°ê²° ê³ ë¦¬ ìˆ˜ì •)

ë°±ì—”ë“œ ì²˜ë¦¬ ë¶€ë¶„ì—ì„œ `google_auth.py`ì˜ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ë•Œ, ë” ì´ìƒ `credentials_path`ë¥¼ ë„˜ê²¨ì£¼ì§€ ì•Šë„ë¡ ìˆ˜ì •í•©ë‹ˆë‹¤.

*   **ëª©í‘œ:** `get_google_services` í•¨ìˆ˜ í˜¸ì¶œ ë°©ì‹ ë³€ê²½.

```python
# backend_processor.py

# ... (ë‹¤ë¥¸ import ë° ì½”ë“œë“¤ì€ ê·¸ëŒ€ë¡œ ìœ ì§€) ...
import os
import logging
# watchdog, queue ë“± í•„ìš”í•œ import

# â­ google_auth ëª¨ë“ˆ ì„í¬íŠ¸ â­
try:
    # google_auth ì—ì„œ get_google_services í•¨ìˆ˜ ê°€ì ¸ì˜¤ê¸°
    from .google_auth import get_google_services
    from .path_utils import CACHE_FILE_STR, PROCESSED_STATE_FILE_STR # ìºì‹œ íŒŒì¼ ê²½ë¡œ ë“±
except ImportError:
     print("ì˜¤ë¥˜: google_auth ë˜ëŠ” path_utils ëª¨ë“ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
     get_google_services = None
     CACHE_FILE_STR = 'line_cache.json'
     PROCESSED_STATE_FILE_STR = 'processed_state.json'


# ... (ì „ì—­ ë³€ìˆ˜, ë¡œê¹…, ìºì‹œ ë¡œë“œ/ì €ì¥, EventHandler ë“± ê¸°ì¡´ ì½”ë“œ ìœ ì§€) ...
# ì˜ˆ: setup_backend_logging, load_line_cache, save_line_cache, TxtFileEventHandler, process_file ë“±


# --- ë©”ì¸ ëª¨ë‹ˆí„°ë§ í•¨ìˆ˜ ---
def run_monitoring(config, log_func_threadsafe, stop_event):
    """ ë°±ê·¸ë¼ìš´ë“œì—ì„œ í´ë” ê°ì‹œ ë° íŒŒì¼ ì²˜ë¦¬ë¥¼ ì‹¤í–‰í•˜ëŠ” ë©”ì¸ ë£¨í”„ """
    watch_folder = config.get('watch_folder')
    # â­ configì—ì„œ credentials_path ê°€ì ¸ì˜¤ëŠ” ë¶€ë¶„ ì œê±° â­
    # credentials_path = config.get('credentials_path') # ì´ì œ í•„ìš” ì—†ìŒ!

    # ë°±ì—”ë“œ ë¡œê¹… ì‹œìŠ¤í…œ ì´ˆê¸°í™” (ê¸°ì¡´ ì½”ë“œ ìœ ì§€)
    backend_logger = logging.getLogger('backend') # setup_backend_logging() ë“±ìœ¼ë¡œ ì´ˆê¸°í™” ë˜ì—ˆë‹¤ê³  ê°€ì •
    backend_logger.info(f"ê°ì‹œ ì‹œì‘ - í´ë”: {watch_folder}")
    log_func_threadsafe(f"ë°±ì—”ë“œ: ê°ì‹œ ì‹œì‘ - í´ë”: {watch_folder}")

    # ìºì‹œ ë° ìƒíƒœ ë¡œë“œ (ê¸°ì¡´ ì½”ë“œ ìœ ì§€)
    # load_line_cache(log_func_threadsafe)
    # load_processed_state(log_func_threadsafe)
    backend_logger.info("ìºì‹œ ë° ì²˜ë¦¬ ìƒíƒœ ë¡œë“œ ì™„ë£Œ")

    google_services = None
    # Google API ì„œë¹„ìŠ¤ ë¡œë“œ
    if get_google_services: # google_auth.py ê°€ ì„±ê³µì ìœ¼ë¡œ import ë˜ì—ˆëŠ”ì§€ í™•ì¸
        try:
            backend_logger.info("Google API ì„œë¹„ìŠ¤ ë¡œë“œ ì‹œë„")
            # â­ get_google_services í˜¸ì¶œ ì‹œ credentials_path ì¸ì ì œê±°! â­
            # ì´ì „: google_services = get_google_services(credentials_path, log_func_threadsafe)
            google_services = get_google_services(log_func_threadsafe) # ì´ì œ ë¡œê·¸ í•¨ìˆ˜ë§Œ ë„˜ê²¨ì¤Œ

            if google_services and 'docs' in google_services:
                log_func_threadsafe("ë°±ì—”ë“œ: Google Docs ì„œë¹„ìŠ¤ ì¤€ë¹„ ì™„ë£Œ.")
                backend_logger.info("Google Docs ì„œë¹„ìŠ¤ ì¤€ë¹„ ì™„ë£Œ")
                 # Docs ID ìœ íš¨ì„± ê²€ì‚¬ ì½”ë“œ (í•„ìš” ì‹œ ìœ ì§€)
            else:
                 log_func_threadsafe("ê²½ê³ : Google ì„œë¹„ìŠ¤ ë¡œë“œ ì‹¤íŒ¨ (ì¸ì¦ ì˜¤ë¥˜ ë“±). Google Docs ê¸°ë¡ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë©ë‹ˆë‹¤.")
                 backend_logger.error("Google ì„œë¹„ìŠ¤ ë¡œë“œ ì‹¤íŒ¨")
        except Exception as e:
            log_func_threadsafe(f"ì˜¤ë¥˜: Google ì„œë¹„ìŠ¤ ì´ˆê¸°í™” ì¤‘ ì˜ˆì™¸ ë°œìƒ - {e}")
            backend_logger.error(f"Google ì„œë¹„ìŠ¤ ì´ˆê¸°í™” ì˜ˆì™¸: {e}", exc_info=True)
    else:
         log_func_threadsafe("ê²½ê³ : Google ì—°ë™ ëª¨ë“ˆ ë¡œë“œ ì‹¤íŒ¨. Google Docs ê¸°ë¡ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë©ë‹ˆë‹¤.")

    # í´ë” ê°ì‹œì ì„¤ì • ë° ì‹¤í–‰ (ê¸°ì¡´ ì½”ë“œ ìœ ì§€)
    # ... observer, event_handler ì„¤ì • ...
    # ... try...except...finally ë¸”ë¡ (observer.start(), while not stop_event.is_set(), time.sleep, observer.stop(), observer.join()) ...
    # ... process_file í˜¸ì¶œ ì‹œ google_services ê°ì²´ëŠ” ê·¸ëŒ€ë¡œ ë„˜ê²¨ì¤Œ ...
    # finally:
    #    save_line_cache(log_func_threadsafe) # ì¢…ë£Œ ì „ ì €ì¥
    #    save_processed_state(log_func_threadsafe)

```
**ğŸ’¡ ì„¤ëª…:**
*   GUIì—ì„œ ì„¤ì •í•œ `config` ë”•ì…”ë„ˆë¦¬ì—ì„œ `credentials_path`ë¥¼ ì½ì–´ì˜¤ëŠ” ì½”ë“œë¥¼ ì œê±°í–ˆìŠµë‹ˆë‹¤.
*   `get_google_services` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ë•Œ, ë” ì´ìƒ `credentials_path`ë¥¼ ë„˜ê²¨ì£¼ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ì œ `google_auth.py`ê°€ ìŠ¤ìŠ¤ë¡œ `path_utils.py`ë¥¼ í†µí•´ ê²½ë¡œë¥¼ ì•Œì•„ë‚´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

---
### 6ë‹¨ê³„: ì½”ë“œ ìˆ˜ì • - `main_gui.py` (í™”ë©´ ì •ë¦¬ ë° ì„¤ì • ë³€ê²½)

ì‚¬ìš©ì í™”ë©´(GUI)ì—ì„œ `credentials.json` íŒŒì¼ì„ ì„ íƒí•˜ëŠ” ì…ë ¥ì°½ê³¼ ë²„íŠ¼ì„ ëª¨ë‘ ì—†ì• ê³ , ì„¤ì • ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸° ê¸°ëŠ¥ì—ì„œë„ í•´ë‹¹ í•­ëª©ì„ ì œê±°í•©ë‹ˆë‹¤.

*   **ëª©í‘œ:**
    *   Credentials íŒŒì¼ ì„ íƒ UI ìš”ì†Œ(Label, Entry, Button) ì œê±°.
    *   `self.credentials_path` ë³€ìˆ˜ ì œê±°.
    *   `save_config`, `load_config`ì—ì„œ `credentials_path` í•­ëª© ì œê±°.
    *   `start_monitoring`, `validate_inputs`ì—ì„œ `credentials_path` ê´€ë ¨ ë¡œì§ ì œê±°.

```python
# main_gui.py

# ... (ê¸°ì¡´ ì„í¬íŠ¸ ìœ ì§€: tkinter, customtkinter, os, json, threading, queue, logging, pystray ë“±) ...
import customtkinter as ctk
import os
import json
import threading
import queue
import sys
from tkinter import messagebox, filedialog

# path_utilsì—ì„œ ì„¤ì • íŒŒì¼, ë¡œê·¸ í´ë” ì£¼ì†Œ ê°€ì ¸ì˜¤ê¸°
from src.auto_write_txt_to_docs.path_utils import PROJECT_ROOT_STR, CONFIG_FILE_STR, LOG_DIR_STR
# ë°±ì—”ë“œ ì‹¤í–‰ í•¨ìˆ˜ ê°€ì ¸ì˜¤ê¸°
try:
     from src.auto_write_txt_to_docs.backend_processor import run_monitoring
except ImportError:
     print("ë°±ì—”ë“œ ëª¨ë“ˆ ë¡œë“œ ì‹¤íŒ¨")
     run_monitoring = None

# ... (extract_google_id_from_url, get_icon_path ë“± ìœ í‹¸ í•¨ìˆ˜ ìœ ì§€) ...

class MessengerDocsApp:
    def __init__(self, root):
        # ... (root, title, geometry, appearance ì„¤ì • ìœ ì§€) ...
        self.root = root
        self.root.title("ë©”ì‹ ì € Docs ìë™ ê¸°ë¡")

        # --- ë³€ìˆ˜ ì„ ì–¸ ---
        self.watch_folder = ctk.StringVar()
        # â­ self.credentials_path ë³€ìˆ˜ ì œê±° â­
        # self.credentials_path = ctk.StringVar() # ì´ì œ GUIì—ì„œ ì…ë ¥ë°›ì§€ ì•ŠìŒ!
        self.docs_input = ctk.StringVar()

        # ... (is_monitoring, thread, stop_event, log_queue, tray, status_var ë“± ìœ ì§€) ...
        self.is_monitoring = False
        self.log_queue = queue.Queue()
        self.status_var = ctk.StringVar(value="ì¤€ë¹„")


        # ë¡œê¹… ì„¤ì • (ìœ ì§€)
        self.setup_logging()

        # ì„¤ì • ë³€ìˆ˜ ë³€ê²½ ê°ì§€ ì¶”ì 
        self.watch_folder.trace('w', self.on_setting_changed)
        # â­ self.credentials_path ì¶”ì  ì œê±° â­
        # self.credentials_path.trace('w', self.on_setting_changed)
        self.docs_input.trace('w', self.on_setting_changed)
        self.settings_changed = False

        # ... (ì•„ì´ì½˜, ìœ„ì ¯ ìƒì„±, ì„¤ì • ë¡œë“œ, í ì²˜ë¦¬, íŠ¸ë ˆì´ ì„¤ì • ë“± ìœ ì§€) ...
        self.create_widgets()
        self.load_config()
        self.settings_changed = False # ë¡œë“œ í›„ ì´ˆê¸°í™”
        self.root.after(100, self.process_log_queue)
        # ...

    # ... (setup_logging, log, log_threadsafe, process_log_queue, on_setting_changed, update_status ë“± ìœ ì§€) ...

    def create_widgets(self):
        main_frame = ctk.CTkFrame(self.root)
        main_frame.pack(padx=10, pady=10, fill="both", expand=True)
        # ... (ìƒíƒœ í‘œì‹œ í”„ë ˆì„, ì„¤ì • í”„ë ˆì„ Label ë“± ìœ ì§€) ...
        settings_frame = ctk.CTkFrame(main_frame)
        settings_frame.pack(pady=10, padx=10, fill="x")
        ctk.CTkLabel(settings_frame, text="ì„¤ì •", font=ctk.CTkFont(weight="bold")).pack(pady=(5,10))


        # ê°ì‹œ í´ë” ì„¤ì • (â­ ê·¸ëŒ€ë¡œ ìœ ì§€ â­)
        folder_frame = ctk.CTkFrame(settings_frame, fg_color="transparent")
        folder_frame.pack(fill="x", padx=10, pady=5)
        ctk.CTkLabel(folder_frame, text="ê°ì‹œ í´ë”:", width=120).pack(side="left", padx=(0,5))
        ctk.CTkEntry(folder_frame, textvariable=self.watch_folder).pack(side="left", fill="x", expand=True, padx=5)
        ctk.CTkButton(folder_frame, text="í´ë” ì„ íƒ...", width=80, command=self.browse_folder).pack(side="left", padx=(5,0))
        # ... (í´ë” ì—´ê¸° ë²„íŠ¼ ë“±)

        # â­â­â­ Credentials íŒŒì¼ ì„¤ì • UI ì „ì²´ ì œê±° â­â­â­
        # cred_frame = ctk.CTkFrame(settings_frame, fg_color="transparent"); cred_frame.pack(fill="x", padx=10, pady=5)
        # ctk.CTkLabel(cred_frame, text="Credentials íŒŒì¼:", width=120).pack(side="left", padx=(0,5))
        # ctk.CTkEntry(cred_frame, textvariable=self.credentials_path).pack(side="left", fill="x", expand=True, padx=5)
        # ctk.CTkButton(cred_frame, text="íŒŒì¼ ì„ íƒ...", width=80, command=self.browse_credentials).pack(side="left", padx=(5,0))
        # ... (íŒŒì¼ ì—´ê¸° ë²„íŠ¼ ë“±)
        # â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­

        # Google Docs URL/ID ì„¤ì • (â­ ê·¸ëŒ€ë¡œ ìœ ì§€ â­)
        docs_frame = ctk.CTkFrame(settings_frame, fg_color="transparent")
        docs_frame.pack(fill="x", padx=10, pady=(5,10))
        ctk.CTkLabel(docs_frame, text="Google Docs URL/ID:", width=120).pack(side="left", padx=(0,5))
        ctk.CTkEntry(docs_frame, textvariable=self.docs_input).pack(side="left", fill="x", expand=True, padx=5)

        # ... (ì œì–´ ë²„íŠ¼, ë¡œê·¸ í”„ë ˆì„ ë“± ë‚˜ë¨¸ì§€ UI ìœ ì§€) ...
        control_frame = ctk.CTkFrame(main_frame, fg_color="transparent")
        control_frame.pack(pady=10, fill="x")
        self.start_button = ctk.CTkButton(control_frame, text="ê°ì‹œ ì‹œì‘", command=self.start_monitoring) # command í™•ì¸
        self.stop_button = ctk.CTkButton(control_frame, text="ê°ì‹œ ì¤‘ì§€", command=self.stop_monitoring, state="disabled")
        ctk.CTkButton(control_frame, text="ì„¤ì • ì €ì¥", command=self.save_config).pack(side="right", padx=10)
        self.start_button.pack(side="left", padx=10)
        self.stop_button.pack(side="left", padx=10)


    def browse_folder(self):
         # í´ë” ì„ íƒ ê¸°ëŠ¥ (ìœ ì§€)
         folder = filedialog.askdirectory(parent=self.root)
         if folder:
             self.watch_folder.set(folder)

    # â­ browse_credentials í•¨ìˆ˜ ì™„ì „íˆ ì œê±° â­
    # def browse_credentials(self): ...

    # â­ save_config í•¨ìˆ˜ ìˆ˜ì •: credentials_path ì €ì¥ ì•ˆ í•¨ â­
    def save_config(self):
        config_data = {
            "watch_folder": self.watch_folder.get(),
            # "credentials_path": self.credentials_path.get(), # ğŸ‘ˆ ì €ì¥ ì œê±°
            "docs_input": self.docs_input.get()
        }
        try:
            # path_utils ì˜ CONFIG_FILE_STR ì‚¬ìš©
            with open(CONFIG_FILE_STR, 'w', encoding='utf-8') as f:
                 json.dump(config_data, f, indent=4, ensure_ascii=False)
            self.log("ì„¤ì • ì €ì¥ ì™„ë£Œ.")
            self.settings_changed = False
        except Exception as e:
             messagebox.showerror("ì €ì¥ ì˜¤ë¥˜", f"ì„¤ì • ì €ì¥ ì‹¤íŒ¨:\n{e}", parent=self.root)
             self.log(f"ì˜¤ë¥˜: ì„¤ì • ì €ì¥ ì‹¤íŒ¨ - {e}")

    # â­ load_config í•¨ìˆ˜ ìˆ˜ì •: credentials_path ë¶ˆëŸ¬ì˜¤ì§€ ì•ŠìŒ â­
    def load_config(self):
         # path_utils ì˜ CONFIG_FILE_STR ì‚¬ìš©
        if os.path.exists(CONFIG_FILE_STR):
            try:
                with open(CONFIG_FILE_STR, 'r', encoding='utf-8') as f:
                     config_data = json.load(f)
                self.watch_folder.set(config_data.get("watch_folder", ""))
                # self.credentials_path.set(config_data.get("credentials_path", "")) # ğŸ‘ˆ ë¡œë“œ ì œê±°
                self.docs_input.set(config_data.get("docs_input", ""))
                self.log("ì €ì¥ëœ ì„¤ì • ë¡œë“œ ì™„ë£Œ.")
            except Exception as e:
                 self.log(f"ê²½ê³ : ì„¤ì • íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨ - {e}")
        else:
             self.log(f"ì €ì¥ëœ ì„¤ì • íŒŒì¼ ì—†ìŒ: {os.path.basename(CONFIG_FILE_STR)}")


    # â­ validate_inputs í•¨ìˆ˜ ìˆ˜ì •: credentials_path ê²€ì‚¬ ì•ˆ í•¨ â­
    def validate_inputs(self):
        """ì…ë ¥ê°’ ìœ íš¨ì„± ê²€ì‚¬"""
        watch_folder = self.watch_folder.get().strip()
        # credentials_path = self.credentials_path.get().strip() # ğŸ‘ˆ ì œê±°
        docs_input_val = self.docs_input.get().strip()
        errors = []

        # ê°ì‹œ í´ë” ê²€ì‚¬ (ìœ ì§€)
        if not watch_folder: errors.append("ê°ì‹œ í´ë”ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.")
        elif not os.path.isdir(watch_folder): errors.append(f"ê°ì‹œ í´ë”ê°€ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜ í´ë”ê°€ ì•„ë‹™ë‹ˆë‹¤: {watch_folder}")

        # â­ Credentials íŒŒì¼ ê²€ì‚¬ ë¡œì§ ì „ì²´ ì œê±° â­
        # if not credentials_path: errors.append("Credentials íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.")
        # elif not os.path.isfile(credentials_path): errors.append(f"Credentials íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜ íŒŒì¼ì´ ì•„ë‹™ë‹ˆë‹¤: {credentials_path}")
        # ...

        # Google Docs URL/ID ê²€ì‚¬ (ìœ ì§€)
        if not docs_input_val:
             errors.append("Google Docs URL ë˜ëŠ” IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
        # else: ... (ID ì¶”ì¶œ ë° ìœ íš¨ì„± ê²€ì‚¬ ë¡œì§ ìœ ì§€)

        return errors

    # â­ start_monitoring í•¨ìˆ˜ ìˆ˜ì •: config ì— credentials_path ì•ˆ ë„£ìŒ â­
    def start_monitoring(self):
         if not run_monitoring:
              messagebox.showerror("ì‹¤í–‰ ì˜¤ë¥˜", "ë°±ì—”ë“œ ëª¨ë“ˆì„ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.", parent=self.root)
              return

         validation_errors = self.validate_inputs() # ìˆ˜ì •ëœ ê²€ì‚¬ í•¨ìˆ˜ í˜¸ì¶œ
         if validation_errors:
              # ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ (ìœ ì§€)
              messagebox.showerror("ì…ë ¥ ì˜¤ë¥˜", "\n".join(validation_errors), parent=self.root)
              return

         # ... (ì…ë ¥ê°’ ê°€ì ¸ì˜¤ê¸°, ID ì¶”ì¶œ ë“± ìœ ì§€) ...
         watch_folder = self.watch_folder.get().strip()
         docs_input_val = self.docs_input.get().strip()
         # docs_id = extract_google_id_from_url(docs_input_val) # ID ì¶”ì¶œ í•¨ìˆ˜ í•„ìš”

         self.log("ê°ì‹œ ì‹œì‘ ìš”ì²­...")
         self.update_status("ê°ì‹œ ì‹œì‘ ì¤‘...")
         self.is_monitoring = True
         self.stop_event.clear()

         # â­ ë°±ì—”ë“œë¡œ ë„˜ê²¨ì¤„ ì„¤ì •(config)ì—ì„œ credentials_path ì œê±° â­
         current_config = {
             "watch_folder": watch_folder,
             # "credentials_path": self.credentials_path.get().strip(), # ğŸ‘ˆ ì œê±°
             "docs_id": "YOUR_DOCS_ID" # docs_id # ğŸ‘ˆ docs_idëŠ” í•„ìš”í•¨!
         }

         # ë°±ì—”ë“œ ìŠ¤ë ˆë“œ ì‹œì‘ (ìœ ì§€)
         self.monitoring_thread = threading.Thread(
             target=run_monitoring,
             # â­ run_monitoring ì€ config, log_func, stop_event ë¥¼ ë°›ìŒ â­
             args=(current_config, self.log_threadsafe, self.stop_event),
             daemon=True
         )
         self.monitoring_thread.start()

         # ë²„íŠ¼ ìƒíƒœ ë³€ê²½ ë“± (ìœ ì§€)
         self.start_button.configure(state="disabled")
         self.stop_button.configure(state="normal")
         # self.disable_settings_widgets() # ìœ„ì ¯ ë¹„í™œì„±í™” í•¨ìˆ˜ë„ credentials ë¶€ë¶„ ì œê±° í™•ì¸
         self.update_status("ê°ì‹œ ì¤‘")


    # â­ disable_settings_widgets, enable_settings_widgets í•¨ìˆ˜ ìˆ˜ì • â­
    # : Credentials ê´€ë ¨ ìœ„ì ¯ì„ ë¹„í™œì„±í™”/í™œì„±í™” í•˜ëŠ” ì½”ë“œê°€ ìˆë‹¤ë©´ ëª¨ë‘ ì œê±°í•´ì•¼ í•©ë‹ˆë‹¤.
    # (create_widgetsì—ì„œ ì´ë¯¸ UIë¥¼ ì œê±°í–ˆìœ¼ë¯€ë¡œ, ì´ í•¨ìˆ˜ë“¤ ë‚´ì—ì„œ í•´ë‹¹ í”„ë ˆì„/ìœ„ì ¯ì— ì ‘ê·¼í•˜ë ¤ í•˜ë©´ ì˜¤ë¥˜ ë°œìƒ)

    # ... (stop_monitoring, hide_window, show_window, quit_app, on_closing, íŠ¸ë ˆì´ ê´€ë ¨ í•¨ìˆ˜ ë“± ìœ ì§€) ...

# --- ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ --- (ìœ ì§€)
if __name__ == "__main__":
     # ë¡œê·¸ í´ë” ìƒì„± ì‹œë„ (path_utils ê²½ë¡œ ì‚¬ìš©)
     try:
         os.makedirs(LOG_DIR_STR, exist_ok=True)
     except Exception as e:
         print(f"ë¡œê·¸ í´ë” ìƒì„± ì‹¤íŒ¨: {e}")
     root = ctk.CTk()
     app = MessengerDocsApp(root)
     root.mainloop()

```
**ğŸ’¡ ì„¤ëª…:**
*   í™”ë©´ êµ¬ì„±(`create_widgets`), ë³€ìˆ˜(`__init__`), íŒŒì¼ ì„ íƒ í•¨ìˆ˜(`browse_credentials`), ì„¤ì • ì €ì¥/ë¡œë“œ(`save_config`, `load_config`), ìœ íš¨ì„± ê²€ì‚¬(`validate_inputs`), ê°ì‹œ ì‹œì‘(`start_monitoring`) ë“± ëª¨ë“  ê³³ì—ì„œ `credentials_path`ì™€ ê´€ë ¨ëœ ë¶€ë¶„ì„ ê¹¨ë—í•˜ê²Œ ì œê±°í–ˆìŠµë‹ˆë‹¤.
*   ì´ì œ ì‚¬ìš©ìëŠ” í™”ë©´ì—ì„œ Credentials íŒŒì¼ê³¼ ê´€ë ¨ëœ ì–´ë–¤ ê²ƒë„ ë³¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!

---
### 7ë‹¨ê³„: ë²ˆë“¤ë§ (EXE íŒŒì¼ ë§Œë“¤ê¸° - ì°¸ê³ )

ë‚˜ì¤‘ì— PyInstaller ë“±ìœ¼ë¡œ ì‹¤í–‰ íŒŒì¼(`.exe`)ì„ ë§Œë“¤ ë•Œ, `assets` í´ë”(ìš°ë¦¬ê°€ `developer_credentials.json`ì„ ë„£ì–´ë‘” ê³³)ê°€ ì‹¤í–‰ íŒŒì¼ ì•ˆì— í¬í•¨ë˜ë„ë¡ ì˜µì…˜ì„ ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. ê·¸ë˜ì•¼ `path_utils.py`ì˜ `sys._MEIPASS` ë¶€ë¶„ì´ ì œëŒ€ë¡œ ì‘ë™í•©ë‹ˆë‹¤.

*   **PyInstaller ëª…ë ¹ì–´ ì˜ˆì‹œ:**
    ```bash
    pyinstaller --windowed --onefile \
    --add-data "src/auto_write_txt_to_docs/assets:assets" \
    --add-data "assets/icon.png:assets" \
     main_gui.py
    ```
    *   `--add-data "ì›ë³¸í´ë”ê²½ë¡œ;ë¬¶ìŒë‚´ë¶€ê²½ë¡œ"` : `src/.../assets` í´ë” ì „ì²´ë¥¼ ì‹¤í–‰ íŒŒì¼ ë‚´ë¶€ì˜ `assets` ë¼ëŠ” ì´ë¦„ì˜ í´ë”ë¡œ í¬í•¨ì‹œí‚¤ë¼ëŠ” ëœ»ì…ë‹ˆë‹¤. (ì„¸ë¯¸ì½œë¡ `;` ëŒ€ì‹  ì½œë¡ `:`ì„ ì‚¬ìš©í•˜ëŠ” OSë„ ìˆìŠµë‹ˆë‹¤. ë³´í†µ WindowsëŠ” `;`, Linux/Macì€ `:`)

---
### ğŸ‰ ë§ˆë¬´ë¦¬

ì¶•í•˜í•©ë‹ˆë‹¤! ì´ì œ ì‚¬ìš©ìê°€ í›¨ì”¬ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í”„ë¡œê·¸ë¨ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.
ë³€ê²½ëœ íë¦„ì„ ë‹¤ì‹œ í•œë²ˆ ì •ë¦¬í•´ ë³¼ê¹Œìš”?

1.  ì‚¬ìš©ìê°€ `ê°ì‹œ ì‹œì‘` ë²„íŠ¼ í´ë¦­.
2.  `backend_processor`ì˜ `run_monitoring` ì‹œì‘.
3.  `google_auth`ì˜ `get_google_services` í˜¸ì¶œ.
4.  `authenticate` í•¨ìˆ˜ê°€ `path_utils`ë¥¼ í†µí•´ `token.json`(ì‚¬ìš©ì ì¶œì… í—ˆê°€ì¦) ìœ„ì¹˜ í™•ì¸.
5.  `token.json`ì´ ì—†ê±°ë‚˜ ë§Œë£Œë˜ì—ˆë‹¤ë©´, `path_utils`ë¥¼ í†µí•´ `developer_credentials.json`(í”„ë¡œê·¸ë¨ ì‹ ë¶„ì¦) ìœ„ì¹˜ í™•ì¸.
6.  ì‹ ë¶„ì¦ì„ ì´ìš©í•´ ë¸Œë¼ìš°ì € ì°½ì„ ë„ìš°ê³  ì‚¬ìš©ìì—ê²Œ ë¡œê·¸ì¸ ë° 'í—ˆìš©' ìš”ì²­.
7.  ì‚¬ìš©ìê°€ í—ˆìš©í•˜ë©´, `token.json`ì„ ë°œê¸‰ë°›ì•„ ì‚¬ìš©ì í´ë”ì— ì €ì¥.
8.  ìœ íš¨í•œ `token.json`ì„ ì´ìš©í•´ êµ¬ê¸€ ë¬¸ì„œ ì„œë¹„ìŠ¤ì— ì ‘ì†.
9.  ê°ì‹œ ë° ë¬¸ì„œ ì“°ê¸° ì‘ì—… ì‹œì‘!

ì´ì œ ì‚¬ìš©ìëŠ” ë³µì¡í•œ ì„¤ì • ì—†ì´, í”„ë¡œê·¸ë¨ ì²« ì‹¤í–‰ ì‹œ ë¸Œë¼ìš°ì €ì—ì„œ 'í—ˆìš©' ë²„íŠ¼ í´ë¦­ í•œ ë²ˆìœ¼ë¡œ ëª¨ë“  ì¸ì¦ ê³¼ì •ì„ ë§ˆì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì–´ë– ì‹ ê°€ìš”? ì°¨ê·¼ì°¨ê·¼ ë”°ë¼ì˜¤ë‹ˆ ì–´ë µì§€ ì•Šì£ ? ğŸ˜‰
ê°œë°œ ê³¼ì •ì—ì„œ ê¶ê¸ˆí•œ ì ì´ ìˆë‹¤ë©´ ì–¸ì œë“ ì§€ ë‹¤ì‹œ ì§ˆë¬¸í•´ì£¼ì„¸ìš”! í•­ìƒ ì‘ì›í•©ë‹ˆë‹¤!
